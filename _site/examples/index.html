<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Examples &middot; Synvert
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/synvert/css/poole.css">
  <link rel="stylesheet" href="/synvert/css/syntax.css">
  <link rel="stylesheet" href="/synvert/css/hyde.css">
  <link rel="stylesheet" href="/synvert/css/main.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>Synvert</h1>
      <p class="lead">synvert is used to convert ruby code to better syntax.</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="/synvert/">Home</a></li>
      <li class="sidebar-nav-item"><a href="/synvert/get_started/">Get Started</a></li>
      <li class="sidebar-nav-item"><a href="/synvert/examples/">Examples</a></li>
      <li class="sidebar-nav-item"><a href="/synvert/dsl/">DSL</a></li>
      <li class="sidebar-nav-item"><a href="/synvert/helper/">Helper</a></li>
      <li class="sidebar-nav-item"><a href="/synvert/terms/">Terms</a></li>
      <li class="sidebar-nav-item"><a href="/synvert/rules/">Rules</a></li>
      <li class="sidebar-nav-item"><a href="/synvert/write_snippet/">Write Snippet</a></li>
    </ul>

    <p>&copy; <a href="http://xinminlabs.com" target="_blank">Xinmin Labs</a> 2014.
    All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="page">
  <h1 class="page-title">Examples</h1>
  <p>I learn best by examples</p>

<h3>FactoryGirl short syntax method</h3>

<p>Adds <code>include FactoryGirl::Syntax::Methods</code> to class
<code>Test::Unit::TestCase</code> in file <code>test/test_helper.rb</code></p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="n">within_file</span> <span class="s1">&#39;test/test_helper.rb&#39;</span> <span class="k">do</span>
    <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;Test::Unit::TestCase&#39;</span> <span class="k">do</span>
      <span class="n">insert</span> <span class="s1">&#39;include FactoryGirl::Syntax::Methods&#39;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>FactoryGirl short syntax only works from factory_girl 2.0.0, so let&#39;s
check the gem version.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="c1"># check factory_girl gem greater than 2.0.0 in Gemfile.lock</span>
  <span class="n">if_gem</span> <span class="s1">&#39;factory_girl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">gte</span><span class="p">:</span> <span class="s1">&#39;2.0.0&#39;</span><span class="p">}</span>

  <span class="n">within_file</span> <span class="s1">&#39;test/test_helper.rb&#39;</span> <span class="k">do</span>
    <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;Test::Unit::TestCase&#39;</span> <span class="k">do</span>
      <span class="n">insert</span> <span class="s1">&#39;include FactoryGirl::Syntax::Methods&#39;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>It works, but it inserts code every time even <code>include
FactoryGirl::Syntax::Methods</code> already exist in the class, so let&#39;s check
if code doesn&#39;t exist, then insert.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="n">if_gem</span> <span class="s1">&#39;factory_girl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">gte</span><span class="p">:</span> <span class="s1">&#39;2.0.0&#39;</span><span class="p">}</span>

  <span class="n">within_file</span> <span class="s1">&#39;test/test_helper.rb&#39;</span> <span class="k">do</span>
    <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;Test::Unit::TestCase&#39;</span> <span class="k">do</span>
      <span class="c1"># unless include FactoryGirl::Syntax::Methods exists</span>
      <span class="n">unless_exist_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="s1">&#39;include&#39;</span><span class="p">,</span> <span class="ss">arguments</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;FactoryGirl::Syntax::Methods&#39;</span><span class="o">]</span> <span class="k">do</span>
        <span class="n">insert</span> <span class="s1">&#39;include FactoryGirl::Syntax::Methods&#39;</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>It should also work in minitest and activesupport testcase</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="n">if_gem</span> <span class="s1">&#39;factory_girl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">gte</span><span class="p">:</span> <span class="s1">&#39;2.0.0&#39;</span><span class="p">}</span>

  <span class="n">within_file</span> <span class="s1">&#39;test/test_helper.rb&#39;</span> <span class="k">do</span>
    <span class="sx">%w(Test::Unit::TestCase ActiveSupport::TestCase MiniTest::Unit::TestCase</span>
<span class="sx">        MiniTest::Spec MiniTest::Rails::ActiveSupport::TestCase)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">class_name</span><span class="o">|</span>
      <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="n">class_name</span> <span class="k">do</span>
        <span class="n">unless_exist_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="s1">&#39;include&#39;</span><span class="p">,</span> <span class="ss">arguments</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;FactoryGirl::Syntax::Methods&#39;</span><span class="o">]</span> <span class="k">do</span>
          <span class="n">insert</span> <span class="s1">&#39;include FactoryGirl::Syntax::Methods&#39;</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>For rspec, it does a bit different</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="n">if_gem</span> <span class="s1">&#39;factory_girl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">gte</span><span class="p">:</span> <span class="s1">&#39;2.0.0&#39;</span><span class="p">}</span>

  <span class="n">within_file</span> <span class="s1">&#39;spec/spec_helper.rb&#39;</span> <span class="k">do</span>
    <span class="c1"># match code RSpec.configure do |config|; ... end</span>
    <span class="n">within_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="nb">caller</span><span class="p">:</span> <span class="p">{</span><span class="ss">receiver</span><span class="p">:</span> <span class="s1">&#39;RSpec&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="s1">&#39;configure&#39;</span><span class="p">}</span> <span class="k">do</span>
      <span class="n">unless_exist_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="s1">&#39;include&#39;</span><span class="p">,</span> <span class="ss">arguments</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;FactoryGirl::Syntax::Methods&#39;</span><span class="o">]</span> <span class="k">do</span>
        <span class="c1"># {{ }} is executed on current node, so we can add or replace with some old code,</span>
        <span class="c1"># arguments are [config], arguments.first is config,</span>
        <span class="c1"># here we insert `config.include FactoryGirl::Syntax::Methods`</span>
        <span class="n">insert</span> <span class="s2">&quot;{{arguments.first}}.include FactoryGirl::Syntax::Methods&quot;</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Finally, apply it for cucumber as well.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="n">if_gem</span> <span class="s1">&#39;factory_girl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">gte</span><span class="p">:</span> <span class="s1">&#39;2.0.0&#39;</span><span class="p">}</span>

  <span class="n">within_file</span> <span class="s1">&#39;features/support/env.rb&#39;</span> <span class="k">do</span>
    <span class="c1"># current node is the root node of env.rb file</span>
    <span class="c1"># we don&#39;t need with_node / within_node here</span>
    <span class="n">unless_exist_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="s1">&#39;World&#39;</span><span class="p">,</span> <span class="ss">arguments</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;FactoryGirl::Syntax::Methods&#39;</span><span class="o">]</span> <span class="k">do</span>
      <span class="n">insert</span> <span class="s2">&quot;World(FactoryGirl::Syntax::Methods)&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>We already insert <code>FactoryGirl::Syntax::Methods</code> module, then we can
replace <code>FactoryGirl.create</code> with <code>create</code> now.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="n">if_gem</span> <span class="s1">&#39;factory_girl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">gte</span><span class="p">:</span> <span class="s1">&#39;2.0.0&#39;</span><span class="p">}</span>

  <span class="sx">%w(test/**/*.rb spec/**/*.rb features/**/*.rb)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">file_pattern</span><span class="o">|</span>
    <span class="c1"># find all files in test/, spec/ and features/</span>
    <span class="n">within_files</span> <span class="n">file_pattern</span> <span class="k">do</span>
      <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">receiver</span><span class="p">:</span> <span class="s1">&#39;FactoryGirl&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="s1">&#39;create&#39;</span> <span class="k">do</span>
        <span class="c1"># for FactoryGirl.create(:post, title: &#39;post&#39;),</span>
        <span class="c1"># arguments are `:post, title: &#39;post&#39;`</span>
        <span class="n">replace_with</span> <span class="s2">&quot;create({{arguments}})&quot;</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>There are other short syntaxes, e.g. <code>build</code>, <code>create_list</code>, <code>build_list</code>, etc.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="n">if_gem</span> <span class="s1">&#39;factory_girl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">gte</span><span class="p">:</span> <span class="s1">&#39;2.0.0&#39;</span><span class="p">}</span>

  <span class="sx">%w(test/**/*.rb spec/**/*.rb features/**/*.rb)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">file_pattern</span><span class="o">|</span>
    <span class="n">within_files</span> <span class="n">file_pattern</span> <span class="k">do</span>
      <span class="sx">%w(create build attributes_for build_stubbed create_list build_list</span>
<span class="sx">          create_pair build_pair)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">message</span><span class="o">|</span>
        <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">receiver</span><span class="p">:</span> <span class="s1">&#39;FactoryGirl&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="n">message</span> <span class="k">do</span>
          <span class="n">replace_with</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="s2">({{arguments}})&quot;</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Finally don&#39;t forget to add description for the rewriter</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;factory_girl_short_syntax&#39;</span> <span class="k">do</span>
  <span class="n">description</span> <span class="o">&lt;&lt;-</span><span class="no">EOF</span>
<span class="sh">1. it adds FactoryGirl::Syntax::methods module to RSpec, Test::Unit,</span>
<span class="sh">   Cucumber, Spainach, MiniTest, MiniTest::Spec, minitest-rails.</span>

<span class="sh">2. it converts to short syntax.</span>

<span class="sh">    FactoryGirl.create(...) =&gt; create(...)</span>
<span class="sh">    FactoryGirl.build(...) =&gt; build(...)</span>
<span class="sh">    ......</span>
<span class="no">  EOF</span>

  <span class="n">if_gem</span> <span class="s1">&#39;factory_girl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">gte</span><span class="p">:</span> <span class="s1">&#39;2.0.0&#39;</span><span class="p">}</span>

  <span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span>
<span class="k">end</span>
</code></pre></div>
<h3>Convert dynamic finders</h3>

<p>From rails 4, dynamic finder methods (e.g.
<code>User.find_all_by_login(&#39;richard&#39;)</code>) is deprecated, we should use
<code>User.where(login: &#39;richrd&#39;)</code> instead.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s2">&quot;convert_dynamic_finders&quot;</span> <span class="k">do</span>
  <span class="n">within_files</span> <span class="s1">&#39;**/*.rb&#39;</span> <span class="k">do</span>
    <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="sr">/find_all_by_(.*)/</span> <span class="k">do</span>
      <span class="c1"># node is current matching ast node</span>
      <span class="c1"># you can add any ruby code in the block</span>
      <span class="c1"># here we convert dynamic finder message to hash params, e.g.</span>
      <span class="c1"># login_and_email(&#39;login&#39;, &#39;email&#39;) to</span>
      <span class="c1"># login: &#39;login&#39;, email: &#39;email&#39;</span>
      <span class="c1">#</span>
      <span class="c1"># node.to_source is used to get original ruby source code</span>
      <span class="c1"># {{receiver}} gets the receiver of current ast node</span>
      <span class="n">fields</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">to_s</span><span class="o">[</span><span class="s2">&quot;find_all_by_&quot;</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_and_&quot;</span><span class="p">)</span>
      <span class="n">hash_params</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
        <span class="n">fields</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="n">arguments</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="n">to_source</span>
      <span class="p">}</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
      <span class="n">replace_with</span> <span class="s2">&quot;{{receiver}}.where(</span><span class="si">#{</span><span class="n">hash_params</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>We can use this snippet to convert other dynamic finders, e.g.
<code>find_last_by_</code>, but we don&#39;t want to calculate the hash_params
in each instance, so let&#39;s use helper_method for reuse.</p>
<div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="no">Synvert</span><span class="o">::</span><span class="no">Rewriter</span><span class="o">.</span><span class="n">new</span> <span class="s2">&quot;convert_dynamic_finders&quot;</span> <span class="k">do</span>
  <span class="n">helper_method</span> <span class="s1">&#39;dynamic_finder_to_hash&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">prefix</span><span class="o">|</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">to_s</span><span class="o">[</span><span class="n">prefix</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_and_&quot;</span><span class="p">)</span>
    <span class="n">fields</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
      <span class="n">fields</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="n">arguments</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="n">to_source</span>
    <span class="p">}</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">within_files</span> <span class="s1">&#39;**/*.rb&#39;</span> <span class="k">do</span>
    <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="sr">/find_all_by_(.*)/</span> <span class="k">do</span>
      <span class="n">hash_params</span> <span class="o">=</span> <span class="n">dynamic_finder_to_hash</span><span class="p">(</span><span class="s2">&quot;find_all_by_&quot;</span><span class="p">)</span>
      <span class="n">replace_with</span> <span class="s2">&quot;{{receiver}}.where(</span><span class="si">#{</span><span class="n">hash_params</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="n">within_files</span> <span class="s1">&#39;**/*.rb&#39;</span> <span class="k">do</span>
    <span class="n">with_node</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="ss">message</span><span class="p">:</span> <span class="sr">/find_last_by_(.*)/</span> <span class="k">do</span>
      <span class="n">hash_params</span> <span class="o">=</span> <span class="n">dynamic_finder_to_hash</span><span class="p">(</span><span class="s2">&quot;find_last_by_&quot;</span><span class="p">)</span>
      <span class="n">replace_with</span> <span class="s2">&quot;{{receiver}}.where(</span><span class="si">#{</span><span class="n">hash_params</span><span class="si">}</span><span class="s2">).last&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
</div>

    </div>

    <script>
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id; js.async=1;
    js.src="https://platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-49054619-1");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

  </body>
</html>
